<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sistema Escolar — Sem Login</title>

<style>
body { margin: 0; font-family: Arial, sans-serif; display: flex; height: 100vh; }
#sidebar { width: 250px; background: #2c3e50; color: #ecf0f1; display: flex; flex-direction: column; padding: 20px; }
#sidebar h2 { margin-top: 0; }
#sidebar button { background: none; color: #ecf0f1; border: none; text-align: left; padding: 10px; cursor: pointer; width: 100%; font-size: 16px; }
#sidebar button:hover { background: #34495e; }

#content { flex: 1; padding: 20px; overflow-y: auto; }
.section { padding: 15px; border: 1px solid #ccc; border-radius: 8px; }
.hidden { display: none; }

table { border-collapse: collapse; margin-top: 15px; width: 100%; }
table th, table td { border: 1px solid #ccc; padding: 8px; text-align: left; }

label { display: block; margin-top: 10px; }
input, select { width: 100%; padding: 8px; margin-top: 5px; }
button.action { padding: 10px 15px; margin-top: 10px; }

.btn { padding: 8px 14px; cursor: pointer; border: none; border-radius: 6px; }
.primary { background: #3498db; color: white; }
.danger { background: #e74c3c; color: white; }
</style>
</head>
<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <h2>Sistema Escolar</h2>
  <button onclick="showSection('professoresSection')">Professores</button>
  <button onclick="showSection('turmasSection')">Turmas</button>
  <button onclick="showSection('horariosSection')">Horários</button>
  <button onclick="showSection('screen-admin')">Administração</button>
</div>

<!-- CONTENT -->
<div id="content">

  <!-- PROFESSORES -->
  <div id="professoresSection" class="section">
    <h2>Cadastro de Professores</h2>

    <label>Nome</label>
    <input id="profNome" type="text" />

    <label>Disciplina</label>
    <input id="profDisciplina" type="text" />

    <button class="action primary" onclick="salvarProfessor()">Salvar</button>

    <h3>Lista de Professores</h3>
    <table>
      <thead>
        <tr><th>Nome</th><th>Disciplina</th><th>Ações</th></tr>
      </thead>
      <tbody id="profTable"></tbody>
    </table>
  </div>

  <!-- TURMAS -->
  <div id="turmasSection" class="section hidden">
    <h2>Cadastro de Turmas</h2>

    <label>Nome da Turma</label>
    <input id="turmaNome" type="text" />

    <button class="action primary" onclick="salvarTurma()">Salvar</button>

    <h3>Lista de Turmas</h3>
    <table>
      <thead><tr><th>Turma</th><th>Ações</th></tr></thead>
      <tbody id="turmaTable"></tbody>
    </table>
  </div>

  <!-- HORÁRIOS -->
  <div id="horariosSection" class="section hidden">
    <h2>Horários</h2>

    <label>Turma</label>
    <select id="horarioTurma"></select>

    <label>Professor</label>
    <select id="horarioProfessor"></select>

    <label>Dia</label>
    <select id="horarioDia">
      <option>Segunda</option>
      <option>Terça</option>
      <option>Quarta</option>
      <option>Quinta</option>
      <option>Sexta</option>
    </select>

    <label>Horário</label>
    <input id="horarioHora" type="time" />

    <button class="action primary" onclick="salvarHorario()">Salvar</button>

    <h3>Grade</h3>
    <table>
      <thead>
        <tr><th>Turma</th><th>Professor</th><th>Dia</th><th>Hora</th><th>Ações</th></tr>
      </thead>
      <tbody id="horarioTable"></tbody>
    </table>
  </div>

  <!-- ADMIN -->
  <div id="screen-admin" class="section hidden">
    <h2>Administração</h2>

    <label>Usuário</label><input type="text" id="adminUser">
    <label>Senha</label><input type="text" id="adminPass">
    <label>Role</label>
    <select id="adminRole">
      <option value="admin">admin</option>
      <option value="user">user</option>
    </select>

    <button class="btn primary" id="btnCreateUser">Criar usuário</button>

    <h3>Lista de Usuários</h3>
    <ul id="listUsers"></ul>
  </div>
</div>

<script>
/* ============================
   BANCO DE DADOS LOCAL
============================ */
const KEY = "SISTEMA_ESCOLAR_DATA";

let state = {
  users: [],
  professors: [],
  turmas: [],
  horarios: []
};

function saveState() {
  localStorage.setItem(KEY, JSON.stringify(state));
}

function loadState() {
  const raw = localStorage.getItem(KEY);
  if (raw) {
    try { Object.assign(state, JSON.parse(raw)); }
    catch(e) { console.warn("Erro ao carregar storage:", e); }
  }

  // Usuário padrão (login desabilitado)
  if (state.users.length === 0) {
    state.users.push({ username:"admin", password:"admin", role:"admin" });
  }
}

loadState();

/* ============================
   NAVEGAÇÃO ENTRE TELAS
============================ */
function showSection(id) {
  document.querySelectorAll(".section").forEach(sec => sec.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

/* ============================
   PROFESSORES
============================ */
function salvarProfessor() {
  const nome = profNome.value.trim();
  const disc = profDisciplina.value.trim();

  if (!nome) return alert("Digite um nome.");

  state.professors.push({
    id: Date.now(),
    nome,
    disciplina: disc
  });

  saveState();
  renderProfessores();

  profNome.value = "";
  profDisciplina.value = "";
}

function renderProfessores() {
  profTable.innerHTML = "";

  state.professors.forEach(p => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${p.nome}</td>
      <td>${p.disciplina}</td>
      <td>
        <button class="danger" onclick="delProf(${p.id})">Excluir</button>
      </td>
    `;
    profTable.appendChild(tr);
  });

  renderProfessoresSelect();
}

function delProf(id) {
  state.professors = state.professors.filter(p => p.id !== id);
  saveState();
  renderProfessores();
}

function renderProfessoresSelect() {
  horarioProfessor.innerHTML = "";
  state.professors.forEach(p => {
    let opt = document.createElement("option");
    opt.value = p.nome;
    opt.textContent = p.nome;
    horarioProfessor.appendChild(opt);
  });
}

/* ============================
   TURMAS
============================ */
function salvarTurma() {
  const nome = turmaNome.value.trim();
  if (!nome) return alert("Digite o nome da turma.");

  state.turmas.push({
    id: Date.now(),
    nome
  });

  saveState();
  renderTurmas();

  turmaNome.value = "";
}

function renderTurmas() {
  turmaTable.innerHTML = "";
  horarioTurma.innerHTML = "";

  state.turmas.forEach(t => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${t.nome}</td>
      <td>
        <button class="danger" onclick="delTurma(${t.id})">Excluir</button>
      </td>
    `;
    turmaTable.appendChild(tr);

    let opt = document.createElement("option");
    opt.value = t.id;
    opt.textContent = t.nome;
    horarioTurma.appendChild(opt);
  });
}

function delTurma(id) {
  state.turmas = state.turmas.filter(t => t.id !== id);
  saveState();
  renderTurmas();
}

/* ============================
   HORÁRIOS
============================ */
function salvarHorario() {
  const turma = horarioTurma.value;
  const prof = horarioProfessor.value;
  const dia = horarioDia.value;
  const hora = horarioHora.value;

  if (!turma || !prof || !hora)
    return alert("Preencha todos os campos.");

  state.horarios.push({
    id: Date.now(),
    turma,
    prof,
    dia,
    hora
  });

  saveState();
  renderHorarios();
}

function renderHorarios() {
  horarioTable.innerHTML = "";

  state.horarios.forEach(h => {
    const turmaObj = state.turmas.find(t => t.id == h.turma);

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${turmaObj ? turmaObj.nome : ""}</td>
      <td>${h.prof}</td>
      <td>${h.dia}</td>
      <td>${h.hora}</td>
      <td>
        <button class="danger" onclick="delHorario(${h.id})">Excluir</button>
      </td>
    `;
    horarioTable.appendChild(tr);
  });
}

function delHorario(id) {
  state.horarios = state.horarios.filter(h => h.id !== id);
  saveState();
  renderHorarios();
}

/* ============================
   ADMINISTRAÇÃO
============================ */
btnCreateUser.onclick = () => {
  const u = adminUser.value.trim();
  const p = adminPass.value.trim();
  const r = adminRole.value;

  if (!u || !p) return alert("Preencha usuário e senha.");

  state.users.push({ username: u, password: p, role: r });
  saveState();
  renderUsers();

  adminUser.value = "";
  adminPass.value = "";
};

function renderUsers() {
  listUsers.innerHTML = "";
  state.users.forEach(u => {
    const li = document.createElement("li");
    li.innerHTML = `<strong>${u.username}</strong> - ${u.role}`;
    listUsers.appendChild(li);
  });
}

/* ============================
   INICIALIZAÇÃO
============================ */
function init() {
  renderProfessores();
  renderTurmas();
  renderHorarios();
  renderUsers();
}

init();
</script>
</body>
</html>
